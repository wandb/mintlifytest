---
- title: Ops
- description: Weaveã§ã™ã¹ã¦ã®å‘¼ã³å‡ºã—ã‚’è‡ªå‹•çš„ã«ãƒ­ã‚°ã«è¨˜éŒ²ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã•ã‚ŒãŸé–¢æ•°
---

Weave opã¯ã€ã™ã¹ã¦ã®å‘¼ã³å‡ºã—ã‚’è‡ªå‹•çš„ã«ãƒ­ã‚°ã«è¨˜éŒ²ã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã•ã‚ŒãŸé–¢æ•°ã§ã™ã€‚

<Tabs>
  <Tab title="Python">
    opã‚’ä½œæˆã™ã‚‹ã«ã¯ã€Pythonã®é–¢æ•°ã‚’`weave.op()`

    ```python showLineNumbers
    import weave

    @weave.op()
    def track_me(v):
        return v + 5

    weave.init('intro-example')
    track_me(15)
    ```

    opã‚’å‘¼ã³å‡ºã™ã¨ã€ã‚³ãƒ¼ãƒ‰ãŒå‰å›ã®å‘¼ã³å‡ºã—ã‹ã‚‰å¤‰æ›´ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯æ–°ã—ã„opãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒä½œæˆã•ã‚Œã€é–¢æ•°ã®å…¥åŠ›ã¨å‡ºåŠ›ãŒãƒ­ã‚°ã«è¨˜éŒ²ã•ã‚Œã¾ã™ã€‚

    :::note
    ã§ãƒ‡ã‚³ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸé–¢æ•°ã¯`@weave.op()`ãã‚Œã‚‰ã‚’å‘¼ã³å‡ºã™å‰ã«`weave.init('your-project-name')`ã‚’å‘¼ã³å‡ºã•ãªã„å ´åˆã€é€šå¸¸é€šã‚Šï¼ˆã‚³ãƒ¼ãƒ‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã¨è¿½è·¡ãªã—ã§ï¼‰å‹•ä½œã—ã¾ã™ã€‚
    :::

    Opsã¯[served](/ja/guides/tools/serve)ã¾ãŸã¯[deployed](/ja/guides/tools/deploy)Weave toolbeltã‚’ä½¿ç”¨ã—ã¦è¡Œã†ã“ã¨ãŒã§ãã¾ã™ã€‚
  </Tab>

  <Tab title="TypeScript">
    opã‚’ä½œæˆã™ã‚‹ã«ã¯ã€TypeScripté–¢æ•°ã‚’`weave.op`

    ```typescript showLineNumbers
    import * as weave from 'weave'

    function trackMe(v: number) {
        return v + 5
    }

    const trackMeOp = weave.op(trackMe)
    trackMeOp(15)

    // You can also do this inline, which may be more convenient
    const trackMeInline = weave.op((v: number) => v + 5)
    trackMeInline(15)
    ```
  </Tab>
</Tabs>

## è¡¨ç¤ºåã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹

<Tabs>
  <Tab title="Python">
    opã®è¡¨ç¤ºåã¯`name`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’`@weave.op` decorator:

    ```python
    @weave.op(name="custom_name")
    def func():
        ...
    ```
  </Tab>

  <Tab title="TypeScript">
    ```plaintext
    This feature is not available in TypeScript yet.  Stay tuned!
    ```
  </Tab>
</Tabs>

## ãƒ­ã‚°ã«è¨˜éŒ²ã•ã‚Œã‚‹å…¥åŠ›ã¨å‡ºåŠ›ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹

<Tabs>
  <Tab title="Python">
    å…ƒã®é–¢æ•°ã‚’å¤‰æ›´ã›ãšã«weaveã«ãƒ­ã‚°è¨˜éŒ²ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã—ãŸã„å ´åˆï¼ˆä¾‹ï¼šæ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’éš ã™ãŸã‚ï¼‰ã€`postprocess_inputs`ã¨`postprocess_output`ã‚’opãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã«æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚

    `postprocess_inputs`ã¯å¼•æ•°åã‚’ã‚­ãƒ¼ã¨ã—ã€å¼•æ•°å€¤ã‚’å€¤ã¨ã™ã‚‹è¾æ›¸ã‚’å—ã‘å–ã‚Šã€å¤‰æ›ã•ã‚ŒãŸå…¥åŠ›ã‚’æŒã¤è¾æ›¸ã‚’è¿”ã—ã¾ã™ã€‚

    `postprocess_output`ã¯é€šå¸¸é–¢æ•°ã«ã‚ˆã£ã¦è¿”ã•ã‚Œã‚‹ä»»æ„ã®å€¤ã‚’å—ã‘å–ã‚Šã€å¤‰æ›ã•ã‚ŒãŸå‡ºåŠ›ã‚’è¿”ã—ã¾ã™ã€‚

    ```py
    from dataclasses import dataclass
    from typing import Any
    import weave

    @dataclass
    class CustomObject:
        x: int
        secret_password: str

    def postprocess_inputs(inputs: dict[str, Any]) -> dict[str, Any]:
        return {k:v for k,v in inputs.items() if k != "hide_me"}

    def postprocess_output(output: CustomObject) -> CustomObject:
        return CustomObject(x=output.x, secret_password="REDACTED")

    @weave.op(
        postprocess_inputs=postprocess_inputs,
        postprocess_output=postprocess_output,
    )
    def func(a: int, hide_me: str) -> CustomObject:
        return CustomObject(x=a, secret_password=hide_me)

    weave.init('hide-data-example') # ğŸ
    func(a=1, hide_me="password123")
    ```
  </Tab>

  <Tab title="TypeScript">
    ```plaintext
    This feature is not available in TypeScript yet.  Stay tuned!
    ```
  </Tab>
</Tabs>

## ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã‚’åˆ¶å¾¡ã™ã‚‹

<Tabs>
  <Tab title="Python">
    opã®å‘¼ã³å‡ºã—ãŒãƒˆãƒ¬ãƒ¼ã‚¹ã•ã‚Œã‚‹é »åº¦ã¯`tracing_sample_rate`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’`@weave.op`ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã§è¨­å®šã™ã‚‹ã“ã¨ã§åˆ¶å¾¡ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€å‘¼ã³å‡ºã—ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã®ã¿ã‚’ãƒˆãƒ¬ãƒ¼ã‚¹ã™ã‚‹å¿…è¦ãŒã‚ã‚‹é«˜é »åº¦ã®opsã«å½¹ç«‹ã¡ã¾ã™ã€‚

    ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã¯ãƒ«ãƒ¼ãƒˆå‘¼ã³å‡ºã—ã«ã®ã¿é©ç”¨ã•ã‚Œã‚‹ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚opã«ã‚µãƒ³ãƒ—ãƒ«ãƒ¬ãƒ¼ãƒˆãŒã‚ã£ã¦ã‚‚ã€æœ€åˆã«åˆ¥ã®opã«ã‚ˆã£ã¦å‘¼ã³å‡ºã•ã‚ŒãŸå ´åˆã€ãã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã¯ç„¡è¦–ã•ã‚Œã¾ã™ã€‚

    ```python
    @weave.op(tracing_sample_rate=0.1)  # Only trace ~10% of calls
    def high_frequency_op(x: int) -> int:
        return x + 1

    @weave.op(tracing_sample_rate=1.0)  # Always trace (default)
    def always_traced_op(x: int) -> int:
        return x + 1
    ```

    opã®å‘¼ã³å‡ºã—ãŒã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã•ã‚Œãªã„å ´åˆï¼š

    * é–¢æ•°ã¯é€šå¸¸é€šã‚Šå®Ÿè¡Œã•ã‚Œã¾ã™
    * ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã¯Weaveã«é€ä¿¡ã•ã‚Œã¾ã›ã‚“
    * ãã®å‘¼ã³å‡ºã—ã®å­opsã‚‚ãƒˆãƒ¬ãƒ¼ã‚¹ã•ã‚Œã¾ã›ã‚“

    ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã¯0.0ã‹ã‚‰1.0ã¾ã§ã®é–“ï¼ˆä¸¡ç«¯ã‚’å«ã‚€ï¼‰ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚
  </Tab>

  <Tab title="TypeScript">
    ```plaintext
    This feature is not available in TypeScript yet. Stay tuned!
    ```
  </Tab>
</Tabs>

## å‘¼ã³å‡ºã—ãƒªãƒ³ã‚¯å‡ºåŠ›ã‚’åˆ¶å¾¡ã™ã‚‹

ãƒ­ã‚®ãƒ³ã‚°ä¸­ã®å‘¼ã³å‡ºã—ãƒªãƒ³ã‚¯ã®å°åˆ·ã‚’æŠ‘åˆ¶ã—ãŸã„å ´åˆã¯ã€`WEAVE_PRINT_CALL_LINK`ç’°å¢ƒå¤‰æ•°ã‚’`false`ã«è¨­å®šã§ãã¾ã™ã€‚ã“ã‚Œã¯å‡ºåŠ›ã®å†—é•·æ€§ã‚’æ¸›ã‚‰ã—ã€ãƒ­ã‚°ã®æ··é›‘ã‚’æ¸›ã‚‰ã™ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚

```bash
export WEAVE_PRINT_CALL_LINK=false
```

## opã‚’å‰Šé™¤ã™ã‚‹

<Tabs>
  <Tab title="Python">
    opã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å‰Šé™¤ã™ã‚‹ã«ã¯ã€op refã§`.delete()`ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

    ```python
    weave.init('intro-example')
    my_op_ref = weave.ref('track_me:v1')
    my_op_ref.delete()
    ```

    å‰Šé™¤ã•ã‚ŒãŸopã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚
  </Tab>

  <Tab title="TypeScript">
    ```plaintext
    This feature is not available in TypeScript yet.  Stay tuned!
    ```
  </Tab>
</Tabs>
